clear; clc; close all;

% Description: Solves a gradient descent problem.

ux = @(t,r) -(18*(1-3*r(1))).*exp(-2*r(1).^2-(3*r(2)+1).^2) ...
            - 6*(1-3*r(1)).^2.*2.*r(1).*exp(-2*r(1).^2-(3*r(2)+1).^2) ...
            - (10*(3/5-81*r(1).^2)).*exp(-7*r(1).^2-6*r(2).^2) ...
            + (20*((3/5)*r(1)-27*r(1).^3-243*r(2).^5)).*7.*r(1).*exp(-7*r(1).^2-6*r(2).^2) ...
            - (1/3*(-18*r(1)-6)).*exp(-(3*r(1)+1).^2-9*r(2).^2)+2*r(1);
        
uy = @(t,r) 3*(1-3*r(1)).^2.*(-18*r(2)-6).*exp(-2*r(1).^2-(3*r(2)+1).^2) ...
            + 12150*r(2).^4.*exp(-7*r(1).^2-6*r(2).^2) ...
            + (20*((3/5)*r(1)-27*r(1).^3-243*r(2).^5)).*6.*r(2).*exp(-7*r(1).^2-6*r(2).^2) ...
            + 6*r(2).*exp(-(3*r(1)+1).^2-9*r(2).^2)+2*r(2);

odefun = @(t,r) [-ux(t,r); -uy(t,r)];
        
% Initial values
x0 = -0.12; y0 = 0.62;


% Gradient Descent
[t,r] = ode45(odefun,0:0.001:5.0,[x0,y0]);
